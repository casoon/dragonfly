<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Container System Compatibility Test</title>
  <link rel="stylesheet" href="../../core.css">
  <script src="../browser-compatibility/document-compatibility.js" defer></script>
  <style>
    body {
      font-family: system-ui, sans-serif;
      line-height: 1.5;
      margin: 0;
      padding: 2rem;
    }
    h1 {
      margin-top: 0;
      border-bottom: 1px solid #e2e8f0;
      padding-bottom: 0.5rem;
    }
    .test-container {
      margin-bottom: 2rem;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      overflow: hidden;
    }
    .test-header {
      padding: 1rem;
      background-color: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
    }
    .test-content {
      padding: 1rem;
    }
    .feature-support {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-weight: 600;
    }
    .supported {
      background-color: #dcfce7;
      color: #166534;
    }
    .not-supported {
      background-color: #fee2e2;
      color: #b91c1c;
    }
    .partial {
      background-color: #fef9c3;
      color: #854d0e;
    }
    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
    }
    .browser-info {
      margin-bottom: 2rem;
      padding: 1rem;
      background-color: #f8fafc;
      border-radius: 0.5rem;
    }
    pre {
      background-color: #f1f5f9;
      padding: 0.5rem;
      border-radius: 0.25rem;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #e2e8f0;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background-color: #f8fafc;
    }
    .container-demo {
      margin-top: 1rem;
      min-height: 200px;
      position: relative;
    }
    .container-demo-content {
      padding: 1rem;
      background-color: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
    }
    .test-result {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>Container System Compatibility Test</h1>
  
  <div class="browser-info">
    <h2>Browser Information</h2>
    <div id="browser-info"></div>
  </div>

  <div class="test-container">
    <div class="test-header">
      <h2>Container Query Support</h2>
    </div>
    <div class="test-content">
      <p>Testing support for CSS Container Queries (@container)</p>
      <div class="test-result" id="container-query-test"></div>
      
      <div class="container-demo">
        <div class="container-query" style="resize: horizontal; overflow: auto; min-width: 200px; max-width: 800px; padding: 1rem; border: 1px dashed #64748b;">
          <p>This container supports container queries. Resize to see responsive changes:</p>
          <div class="container-demo-content">
            <p>Container width: <span class="container-width">Calculating...</span></p>
            <div class="responsive-element">
              This element should change based on container width
            </div>
          </div>
        </div>
      </div>
      
      <style>
        @container (width < 300px) {
          .responsive-element {
            background-color: #fee2e2;
            color: #b91c1c;
          }
        }
        @container (width >= 300px) and (width < 500px) {
          .responsive-element {
            background-color: #fef9c3;
            color: #854d0e;
          }
        }
        @container (width >= 500px) {
          .responsive-element {
            background-color: #dcfce7;
            color: #166534;
          }
        }
      </style>
    </div>
  </div>
  
  <div class="test-container">
    <div class="test-header">
      <h2>Container Types</h2>
    </div>
    <div class="test-content">
      <p>Testing different container types:</p>
      <table>
        <thead>
          <tr>
            <th>Container Type</th>
            <th>Description</th>
            <th>Support</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>container-type: size</td>
            <td>Creates a query container for both inline and block dimensions</td>
            <td id="container-type-size"></td>
          </tr>
          <tr>
            <td>container-type: inline-size</td>
            <td>Creates a query container for inline dimensions only</td>
            <td id="container-type-inline-size"></td>
          </tr>
          <tr>
            <td>container-name</td>
            <td>Assigns a name to a container</td>
            <td id="container-name"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  
  <div class="test-container">
    <div class="test-header">
      <h2>Container Layout Classes</h2>
    </div>
    <div class="test-content">
      <div class="test-grid">
        <!-- Basic Containers -->
        <div class="test-container">
          <div class="test-header">
            <h3>Basic Containers</h3>
          </div>
          <div class="test-content">
            <div class="container container-sm" style="background-color: #f8fafc; border: 1px solid #e2e8f0; padding: 1rem;">
              Container with Small Width
            </div>
          </div>
        </div>
        
        <!-- Positioned Containers -->
        <div class="test-container">
          <div class="test-header">
            <h3>Positioned Containers</h3>
          </div>
          <div class="test-content" style="position: relative; height: 100px;">
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; overflow: hidden;">
              <div class="container-absolute-center" style="background-color: #f8fafc; border: 1px solid #e2e8f0; padding: 0.5rem;">
                Absolute Center
              </div>
            </div>
          </div>
        </div>
        
        <!-- Responsive Containers -->
        <div class="test-container">
          <div class="test-header">
            <h3>Responsive Containers</h3>
          </div>
          <div class="test-content">
            <div class="container-fluid" style="background-color: #f8fafc; border: 1px solid #e2e8f0; padding: 1rem;">
              Fluid Container
            </div>
          </div>
        </div>
        
        <!-- Special Containers -->
        <div class="test-container">
          <div class="test-header">
            <h3>Special Containers</h3>
          </div>
          <div class="test-content">
            <div class="container-scrollable" style="height: 100px; background-color: #f8fafc; border: 1px solid #e2e8f0; padding: 1rem;">
              <p>Scrollable Container</p>
              <p>With multiple lines</p>
              <p>To demonstrate scrolling</p>
              <p>When content exceeds height</p>
              <p>Of the container</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Display browser information
      displayBrowserInfo();
      
      // Test container query support
      testContainerQuerySupport();
      
      // Test container types
      testContainerTypes();
      
      // Update container width display
      updateContainerWidth();
      window.addEventListener('resize', updateContainerWidth);
    });
    
    function displayBrowserInfo() {
      const browserInfo = document.getElementById('browser-info');
      browserInfo.innerHTML = `
        <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
        <p><strong>Browser:</strong> ${getBrowserInfo()}</p>
      `;
    }
    
    function getBrowserInfo() {
      const ua = navigator.userAgent;
      let browser = 'Unknown';
      
      if (ua.indexOf('Chrome') > -1) {
        browser = 'Chrome/Edge';
        if (ua.indexOf('Edg') > -1) {
          browser = 'Edge';
        }
      } else if (ua.indexOf('Firefox') > -1) {
        browser = 'Firefox';
      } else if (ua.indexOf('Safari') > -1) {
        browser = 'Safari';
      }
      
      return browser;
    }
    
    function testContainerQuerySupport() {
      const containerQueryTest = document.getElementById('container-query-test');
      
      // Test if @container is supported
      let isSupported = false;
      try {
        isSupported = CSS.supports('(container-type: inline-size)') || 
                      CSS.supports('(container: inline-size)');
      } catch (e) {
        // CSS.supports might not be available in older browsers
      }
      
      if (isSupported) {
        containerQueryTest.innerHTML = `
          <span class="feature-support supported">Supported</span>
          <p>Your browser supports CSS Container Queries.</p>
        `;
      } else {
        containerQueryTest.innerHTML = `
          <span class="feature-support not-supported">Not Supported</span>
          <p>Your browser does not support CSS Container Queries. Container queries are supported in:</p>
          <ul>
            <li>Chrome 105+</li>
            <li>Firefox 110+</li>
            <li>Safari 16.0+</li>
            <li>Edge 105+</li>
          </ul>
        `;
      }
    }
    
    function testContainerTypes() {
      const containerTypeSize = document.getElementById('container-type-size');
      const containerTypeInlineSize = document.getElementById('container-type-inline-size');
      const containerName = document.getElementById('container-name');
      
      // Test if container-type: size is supported
      let isSizeSupported = false;
      try {
        isSizeSupported = CSS.supports('(container-type: size)');
      } catch (e) {}
      
      // Test if container-type: inline-size is supported
      let isInlineSizeSupported = false;
      try {
        isInlineSizeSupported = CSS.supports('(container-type: inline-size)');
      } catch (e) {}
      
      // Test if container-name is supported
      let isNameSupported = false;
      try {
        isNameSupported = CSS.supports('container-name: example');
      } catch (e) {}
      
      containerTypeSize.innerHTML = isSizeSupported ? 
        '<span class="feature-support supported">Supported</span>' : 
        '<span class="feature-support not-supported">Not Supported</span>';
      
      containerTypeInlineSize.innerHTML = isInlineSizeSupported ? 
        '<span class="feature-support supported">Supported</span>' : 
        '<span class="feature-support not-supported">Not Supported</span>';
      
      containerName.innerHTML = isNameSupported ? 
        '<span class="feature-support supported">Supported</span>' : 
        '<span class="feature-support not-supported">Not Supported</span>';
    }
    
    function updateContainerWidth() {
      const containers = document.querySelectorAll('.container-query');
      const widthDisplays = document.querySelectorAll('.container-width');
      
      containers.forEach((container, index) => {
        if (widthDisplays[index]) {
          widthDisplays[index].textContent = `${container.offsetWidth}px`;
        }
      });
      
      // Update periodically for when user resizes the container
      setTimeout(updateContainerWidth, 100);
    }
  </script>
</body>
</html> 